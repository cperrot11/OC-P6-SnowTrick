{% extends 'base.html.twig' %}

{% block title %}{{ parent() }}{% endblock %}

{% block body %}
    {{ parent() }}
    <section class="row">
        <img class="img-fluid" src="\images\mattias-olsson-160612-unsplash.jpg">
        <h1 class="slogan"> Les figures de Snowboard dans tous les sens !</h1>
        <a id="fleche" href="#start" data-toggle="tooltip" title="Découvrir la suite" class="fas fa-angle-double-down"></a>


        {% for flashMessage in app.session.flashBag.get('registration') %}
            <div class="alert alert-dismissible alert-danger">
                <button type="button" class="close" data-dismiss="alert">&times;</button>
                {{ flashMessage }}
            </div>
        {% endfor %}
    </section>
    <section class="row">
        <h3 id="start" class="text-center col-12">De nombreuses figures sont à votre disposition ({{ tricks|length -1}} en ce moment).</h3>
            {% for trick in tricks %}
                <article class="trick-display">
                    <div class="card text-white bg-secondary m-1">
                        {% if trick.pictures|length>0 %}
                            <a href="{{ path('trick_show', {'id': trick.id}) }}">
                                <div class="card-body"><img src={{ trick.pictures[0].path}} alt="" style="width:100%"></div>
                            </a>
                        {% endif %}

                        <div class="card-footer">
                            <a href="{{ path('trick_show', {'id': trick.id}) }}">
                                {{ trick.name }}({{ trick.id}})
                            </a>
                            {% if is_granted('ROLE_USER') %}
                            <span>
                                <a href="{{ path('trick_edit', {'id': trick.id}) }}" class="fas fa-pen text-right"></a>
                                <a href="{{ path('trick_delete', {'id': trick.id}) }}" class="fas fa-trash-alt text-right"></a>
                            </span>
                            {% endif %}
                        </div>
                    </div>
                </article>
                <span id="trickList"></span>
            {% else %}
                <div>
                    <span colspan="4">no records found</span>
                </div>
            {% endfor %}
            {% if more %}
                <a id="readMore">
                    <h3 id="follow" class="text-center col-12">
                        <i class="fas fa-book-reader"></i>
                        Lire plus...
                    </h3>
                </a>
            {% endif %}
    </section>

    <a href="{{ path('trick_new') }}">Create new</a>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script>
        click = 1;
        jQuery(document).ready(function() {
            $('#follow').on('click', function () {
                click++;
                $('readMore').display=false;
                return $.ajax({
                    url: "{{ path('loadMore') }}"+'/'+click,
                    method: "GET",
                    success: function (response) {
                        $('#readMore').before(response);
                    }}
                );
            })
        })
    </script>
{% endblock  %}
